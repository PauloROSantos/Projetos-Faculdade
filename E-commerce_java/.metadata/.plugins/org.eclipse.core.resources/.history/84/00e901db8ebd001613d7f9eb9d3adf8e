package ecommerce;


import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Scanner;
import java.util.Set;

public class Loja {
	List<Produto> produtos = new ArrayList<Produto>();
	HashMap<Integer, Produto> produtos2 = new HashMap<>();
	Set<Usuario> usuariosReg = new HashSet<Usuario>();
	Usuario usuario1;
	String login = "teste";
	String senha = "teste";
	boolean logado = false;
	Scanner sc = new Scanner(System.in);
	

	
	public Loja(){
		gerarProdutos();
		boasVindas();
		opcoes();
		
	}
	public void loja(){
		boasVindas();
		opcoes();
	}
	


	private void opcoes() {
		String opcao;
		
		System.out.println("-----------------------------------");
		System.out.println();
		System.out.println("Menu de opções: ");
		System.out.println();
		System.out.println("1 - Mostrar pokemons.");
		System.out.println("2 - Registrar usuario.");
		if(!logado){
			System.out.println("3 - login.");
		}else{
			System.out.println("3 - deslogar.");
			System.out.println("4 - mostrar carrinho.");
		}
		System.out.println("00 - sair.");
		System.out.println();
		System.out.println("-----------------------------------");
		opcao = sc.nextLine();
		
		if(opcao.contains("1")){
			mostrarProdutos();
		}else if(opcao.contains("2")){
			registrar();
		}else if((opcao.contains("3")) && (logado)){
			deslogar();
		}else if((opcao.contains("3")) && (!logado)){
			login();
		}else if((opcao.contains("4")) && (logado)){
			areaUsuario();
		}else if (opcao.contains("0")){
			System.out.println("Até a proxima!");
		}else{
			System.out.println("Digite uma opção valida!");
			opcoes();
		}
	}
	private void areaUsuario() {
		System.out.println("-----------------------------------");
		usuario1.mostrarCarrinho();
		System.out.println("-----------------------------------");
		System.out.println("1 - voltar as compras.");
		System.out.println("2 - remover algum item do carrinho.");
		System.out.println("3 - finalizar compra.");
		System.out.println("escolha sua opção:");
		
	}
	private void opcoes2() {
		System.out.println("Escolha um produto ou :");
		System.out.println("99 voltar ao menu anterior.");
		System.out.println("-----------------------------------");
		int opcao = sc.nextInt();
		if( (opcao >= 0) && (opcao < 10)){
			mostrarProduto(opcao);
		}else if(opcao == 99){
			loja();
		}else{
			System.out.println("Escolha uma opção valida");
			opcoes2();
		}
	}

	private void mostrarProduto(int opcao) {
		System.out.println("-----------------------------------");
		System.out.println(produtos2.get(opcao));
		System.out.println("-----------------------------------");
		if(logado){
			System.out.println("1 - adicionar ao carrinho.");
		}
		System.out.println("2 - voltar a loja.");
		System.out.println("-----------------------------------");
		String opcao2 = sc.nextLine();
		if(opcao2.contains("1")){
			usuario1.addNoCarrinho(produtos2.get(opcao));
			System.out.println("-----------------------------------");
			System.out.println("Produto adicionado ao carrinho.");
			System.out.println("-----------------------------------");
			System.out.println("1 - voltar aos produtos e continuar comprando.");
			System.out.println("2 - voltar a loja.");
			System.out.println("3 - mostrar carrinho.");
			System.out.println("-----------------------------------");
			opcao2 = sc.nextLine();
			if(opcao2.contains("1")){
				mostrarProdutos();
			}else if(opcao2.contains("2")){
				loja();
			}else if(opcao2.contains("3")){
				areaUsuario();
			}else{
				System.out.println("Opção invalida.");
				loja();
			}

		}else if(opcao2.contains("2")){
			loja();
		}else{
			System.out.println("Digite uma opção valida.");
			mostrarProduto(opcao);
		}

	}
	private void deslogar() {
		logado = false;
		loja();
		
	}

	private void login() {
		System.out.println("-----------------------------------");
		System.out.println();
		System.out.println("Digite seu login ( seu email ) : ");
		String loginteste = sc.nextLine();
		System.out.println("Digite sua senha: ");
		String senhateste = sc.nextLine();
		System.out.println("-----------------------------------");
		try{
			if( (login.contains(loginteste)) && (senha.contains(senhateste))){
				System.out.println("logado com sucesso");
				System.out.println("-----------------------------------");
				logado = true;
				loja();
			
			}else{
				System.out.println("Senha incorreta.");
				System.out.println("-----------------------------------");
				loja();
			}
			
		}catch(java.lang.NullPointerException e){
			System.out.println("Senha incorreta.");
			System.out.println("-----------------------------------");
		}
		
	}

	private void registrar() {
		System.out.println("Digite seu nome: ");
		String nome = sc.nextLine();
		System.out.println("Digite seu telefone: ");
		String telefone = sc.nextLine();
		System.out.println("Digite seu endereço ");
		String end = sc.nextLine();
		System.out.println("Digite seu email (este será seu login) ");
		String mail = sc.nextLine();
		System.out.println("Digite sua senha: ");
		String senha = sc.nextLine();
		
		usuario1 = new Usuario(nome,telefone,end,mail,senha);
		this.senha = senha;
		this.login = mail;
		System.out.println("-----------------------------------");
		System.out.println("Registro efetuado com sucesso! ");
		System.out.println("-----------------------------------");
		loja();
		
	}

	private void mostrarProdutos() {
		int i = 0;
		for(Produto produtoDaVez : produtos2.values()){
			System.out.println("Opção "+i);
			System.out.println(produtoDaVez);
			System.out.println();
			i++;
		}
		System.out.println("-----------------------------------");
		opcoes2();
	}
	

	public void boasVindas(){
		System.out.println("Bem vindo ao E-commerce PokeGym");
		System.out.println("Aqui você encontra os mais fortes pokemons!");
		System.out.println();
		if(logado){
			System.out.println("Bem vindo: "+usuario1.getNome());
		}else{
			System.out.println("Nenhum usuario logado.");
		}
		
	}


	private void gerarProdutos() {
		
		// Adicionar produtos //
		Produto pokemon1 = new Produto("Pikachu","pokemon do tipo raio",1000.00,2, new Categoria("raio","forte contra agua"));

		Produto pokemon2 = new Produto("Charizard","pokemon voador do tipo fogo",50000.00,1, new Categoria("fogo","um dos elementos mais fortes"));

		Produto pokemon3 = new Produto("Blastoise","Puta bicho da hora",50000.00,1, new Categoria("agual","da um pal no charizard e em pedra"));

		Produto pokemon4 = new Produto("Venusaur","pokemon do tipo planta",50000.00,1, new Categoria("grama","forte contra agua e terra"));

		Produto pokemon5 = new Produto("Pidgey","serve pra nada",50.00,35, new Categoria("voador","pruuu pruuu"));

		Produto pokemon6 = new Produto("Oddish","Não legalizado",4.00,300, new Categoria("mato","forte contra o stress"));

		Produto pokemon7 = new Produto("Psyduck","Pato psiquico",1500.00,5, new Categoria("psiquico","forte contra fantasma"));

		Produto pokemon8 = new Produto("Gengar","Pokemon do tipo fantasma",15000.00,1, new Categoria("fantasma","forte contra fantasma e psiquico"));

		Produto pokemon9 = new Produto("Dragonite","Outro bicho fodao",100000.00,2, new Categoria("dragão","bom contra a maioria dos pokemons"));

		Produto pokemon10 = new Produto("Magikarp","Pior que uma pomba",5.00,15000, new Categoria("comida","serve pra comer"));
		
		produtos2.put(0,pokemon1);
		produtos2.put(1,pokemon2);
		produtos2.put(2,pokemon3);
		produtos2.put(3,pokemon4);
		produtos2.put(4,pokemon5);
		produtos2.put(5,pokemon6);
		produtos2.put(6,pokemon7);
		produtos2.put(7,pokemon8);
		produtos2.put(8,pokemon9);
		produtos2.put(9,pokemon10);
		
		
		
		
		// ------------------ //
		
	}
}
